-- Dashi UI Library (Fixed)

local Library = {}

local Players = game:GetService("Players")
local LP = Players.LocalPlayer

function Library:CreateWindow(cfg)
    local Window = {}

    local gui = Instance.new("ScreenGui")
    gui.Name = "Dashilibrary"
    gui.ResetOnSpawn = false
    gui.Parent = LP:WaitForChild("PlayerGui")

    local main = Instance.new("Frame", gui)
    main.Size = UDim2.fromScale(0.6, 0.7)
    main.Position = UDim2.fromScale(0.2, 0.15)
    main.BackgroundColor3 = Color3.fromRGB(18,18,18)
    main.BorderSizePixel = 0
    Instance.new("UICorner", main).CornerRadius = UDim.new(0,14)

    local side = Instance.new("Frame", main)
    side.Size = UDim2.fromScale(0.23, 1)
    side.BackgroundColor3 = Color3.fromRGB(14,14,14)
    side.BorderSizePixel = 0
    Instance.new("UICorner", side).CornerRadius = UDim.new(0,14)

    local title = Instance.new("TextLabel", side)
    title.Size = UDim2.fromScale(1, 0.12)
    title.BackgroundTransparency = 1
    title.Text = cfg.Title or "Dashi UI"
    title.TextColor3 = Color3.new(1,1,1)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 18

    local tabLayout = Instance.new("UIListLayout", side)
    tabLayout.Padding = UDim.new(0,6)

    local content = Instance.new("Frame", main)
    content.Position = UDim2.fromScale(0.25, 0.05)
    content.Size = UDim2.fromScale(0.72, 0.9)
    content.BackgroundTransparency = 1

    local Tabs = {}

    function Window:CreateTab(name)
        local Tab = {}

        local btn = Instance.new("TextButton", side)
        btn.Size = UDim2.fromScale(1, 0.08)
        btn.Text = name
        btn.BackgroundTransparency = 1
        btn.TextColor3 = Color3.fromRGB(200,200,200)
        btn.Font = Enum.Font.Gotham

        local frame = Instance.new("Frame", content)
        frame.Size = UDim2.fromScale(1,1)
        frame.Visible = false
        frame.BackgroundTransparency = 1

        local layout = Instance.new("UIListLayout", frame)
        layout.Padding = UDim.new(0,12)

        btn.MouseButton1Click:Connect(function()
            for _,t in pairs(Tabs) do
                t.Frame.Visible = false
            end
            frame.Visible = true
        end)

        table.insert(Tabs, {Frame = frame})
        if #Tabs == 1 then frame.Visible = true end

        local function Card(h)
            local f = Instance.new("Frame", frame)
            f.Size = UDim2.new(1,0,0,h)
            f.BackgroundColor3 = Color3.fromRGB(24,24,24)
            f.BorderSizePixel = 0
            Instance.new("UICorner", f).CornerRadius = UDim.new(0,12)
            return f
        end

        function Tab:AddToggle(cfg)
            local c = Card(70)

            local t = Instance.new("TextLabel", c)
            t.Text = cfg.Text
            t.Position = UDim2.fromScale(0.05,0.25)
            t.Size = UDim2.fromScale(0.6,0.4)
            t.BackgroundTransparency = 1
            t.TextColor3 = Color3.new(1,1,1)
            t.Font = Enum.Font.Gotham

            local b = Instance.new("TextButton", c)
            b.Size = UDim2.fromScale(0.15,0.4)
            b.Position = UDim2.fromScale(0.8,0.3)
            b.Text = ""
            b.BackgroundColor3 = Color3.fromRGB(40,40,40)
            Instance.new("UICorner", b).CornerRadius = UDim.new(1,0)

            local on = false
            b.MouseButton1Click:Connect(function()
                on = not on
                b.BackgroundColor3 = on and Color3.fromRGB(0,170,255) or Color3.fromRGB(40,40,40)
                if cfg.Callback then
                    cfg.Callback(on)
                end
            end)
        end

        function Tab:AddButton(cfg)
            local c = Card(60)

            local b = Instance.new("TextButton", c)
            b.Size = UDim2.fromScale(0.9,0.6)
            b.Position = UDim2.fromScale(0.05,0.2)
            b.Text = cfg.Text
            b.BackgroundColor3 = Color3.fromRGB(30,30,30)
            b.TextColor3 = Color3.new(1,1,1)
            b.Font = Enum.Font.Gotham
            Instance.new("UICorner", b)

            b.MouseButton1Click:Connect(function()
                if cfg.Callback then
                    cfg.Callback()
                end
            end)
        end

        return Tab
    end

    return Window
end

return Library
