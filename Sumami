--// Services
local WindUI = loadstring(game:HttpGet(
    "https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"
))()

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer

--// Sky
for _, v in ipairs(Lighting:GetChildren()) do
    if v:IsA("Sky") then
        v:Destroy()
    end
end

local sky = Instance.new("Sky")
sky.SkyboxBk = "rbxassetid://117199031447036"
sky.SkyboxDn = "rbxassetid://117199031447036"
sky.SkyboxFt = "rbxassetid://117199031447036"
sky.SkyboxLf = "rbxassetid://117199031447036"
sky.SkyboxRt = "rbxassetid://117199031447036"
sky.SkyboxUp = "rbxassetid://117199031447036"
sky.Parent = Lighting

--// States
local proxTask = nil
local proxEnabled = false
local infJumpEnabled = false
local infJumpConnection = nil
local bigPart = nil

local magnetEnabled = false
local magnetConn = nil

--// Character utils
local function getCharacter()
    return player.Character or player.CharacterAdded:Wait()
end

local function getHumanoid()
    return getCharacter():WaitForChild("Humanoid")
end

local function getHRP()
    return getCharacter():WaitForChild("HumanoidRootPart")
end

--// Proximity
local function applyProximityZero()
    for _, v in ipairs(Workspace:GetDescendants()) do
        if v:IsA("ProximityPrompt") then
            v.HoldDuration = 0
        end
    end
end

local function enableProximity()
    if proxTask then return end
    proxEnabled = true
    proxTask = task.spawn(function()
        while proxEnabled do
            applyProximityZero()
            task.wait(1)
        end
    end)
end

local function disableProximity()
    proxEnabled = false
    proxTask = nil
end

--// Inf Jump
local function enableInfJump()
    if infJumpConnection then return end
    infJumpEnabled = true
    infJumpConnection = UserInputService.JumpRequest:Connect(function()
        if infJumpEnabled then
            getHumanoid():ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end)
end

local function disableInfJump()
    infJumpEnabled = false
    if infJumpConnection then
        infJumpConnection:Disconnect()
        infJumpConnection = nil
    end
end

--// Magnet Coin
local function getOrSetPrimary(model)
    if model.PrimaryPart then return model.PrimaryPart end
    for _, d in ipairs(model:GetDescendants()) do
        if d:IsA("BasePart") then
            model.PrimaryPart = d
            return d
        end
    end
    return nil
end

local function setCollision(model, state)
    for _, d in ipairs(model:GetDescendants()) do
        if d:IsA("BasePart") then
            d.CanCollide = state
        end
    end
end

local function enableMagnet()
    if magnetConn then return end
    magnetEnabled = true
    magnetConn = RunService.Heartbeat:Connect(function()
        if not magnetEnabled then return end
        local hrp = getHRP()
        local folder = Workspace:FindFirstChild("CandyEventParts")
        if not folder then return end
        for _, m in ipairs(folder:GetChildren()) do
            if m:IsA("Model") then
                local pp = getOrSetPrimary(m)
                if pp then
                    setCollision(m, false)
                    m:SetPrimaryPartCFrame(
                        CFrame.new(hrp.Position + Vector3.new(0, 2, 0))
                    )
                end
            end
        end
    end)
end

local function disableMagnet()
    magnetEnabled = false
    if magnetConn then
        magnetConn:Disconnect()
        magnetConn = nil
    end
    local folder = Workspace:FindFirstChild("CandyEventParts")
    if folder then
        for _, m in ipairs(folder:GetChildren()) do
            if m:IsA("Model") then
                setCollision(m, true)
            end
        end
    end
end

--// Window
local Window = WindUI:CreateWindow({
    Title = "Zaza Hub",
    Icon = "door-open",
    Author = "by Zaza Hub",
    Folder = "ZazaSave",
    Size = UDim2.fromOffset(580, 460),
    MinSize = Vector2.new(560, 350),
    MaxSize = Vector2.new(850, 560),
    Transparent = true,
    Theme = "Dark",
    Resizable = true,
    SideBarWidth = 200,
    Background = "rbxassetid://117199031447036",
    BackgroundImageTransparency = 0.7,
    HideSearchBar = true,
    ScrollBarEnabled = false
})

Window:Tag({
    Title = "v1.0",
    Color = Color3.fromHex("#30ff6a"),
    Radius = 8
})

--// Tabs
local MainTab = Window:Tab({ Title = "Main", Icon = "bird" })
local EventTab = Window:Tab({ Title = "Event", Icon = "star" })

--// Main
MainTab:Section({ Title = "Main" })

MainTab:Toggle({
    Title = "Make Part",
    Desc = "Make Big Part",
    Value = false,
    Callback = function(state)
        if state then
            local hrp = getHRP()
            hrp.CFrame = hrp.CFrame + Vector3.new(0, 10, 0)
            task.wait(0.1)

            bigPart = Instance.new("Part")
            bigPart.Size = Vector3.new(50000, 110, 50000)
            bigPart.Anchored = true
            bigPart.CanCollide = true
            bigPart.Transparency = 0.3
            bigPart.Name = "BigMapPart"
            bigPart.CFrame = hrp.CFrame * CFrame.new(0, -60, 0)
            bigPart.Parent = Workspace
        else
            if bigPart then
                bigPart:Destroy()
                bigPart = nil
            end
        end
    end
})

MainTab:Button({
    Title = "Fly Gui",
    Desc = "Fly Gui",
    Locked = false,
    Callback = function()
        loadstring(game:HttpGet(
            "https://raw.githubusercontent.com/danai1223/Deishiscrit/refs/heads/main/%E0%B8%9A%E0%B8%B4%E0%B8%99%20V1%20by%20Deishi"
        ))()
    end
})

MainTab:Section({ Title = "Mini Function" })

MainTab:Toggle({
    Title = "Proximity 0",
    Icon = "hand",
    Value = false,
    Callback = function(state)
        if state then enableProximity() else disableProximity() end
    end
})

MainTab:Toggle({
    Title = "Inf Jump",
    Icon = "arrow-up",
    Value = false,
    Callback = function(state)
        if state then enableInfJump() else disableInfJump() end
    end
})

--// Event
EventTab:Section({ Title = "Event" })

EventTab:Toggle({
    Title = "Magnet Coin",
    Value = false,
    Callback = function(state)
        if state then enableMagnet() else disableMagnet() end
    end
})

Window.Icon:Enable()
